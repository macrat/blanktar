C言語でfor i inをしたい
2013-02-15 21:10
keywords: C言語 マクロ

メモです、小ネタです、てゆかネタです。<br>
危険ですのであんまり真似しないでください。何が危険って、可読性がやばいです、読めないです。<br>
<pre class="code"><code>#include &lt;stdio.h&gt;

#define PUT(var)	printf("%s = %d\n", #var, var)

#define RANGE(var, start, end) \
int(##var) = start; var != end; var += (start &lt; end ? 1 : -1)

int main()
{
	for(RANGE(a, 0, 10))
		PUT(a);

	for(RANGE(b, 0, -10))
		PUT(b);

	int end = 10;
	for(RANGE(c, 0, end))
	{
		PUT(c);
		if(c &gt; 5)
			end = 0;
	}

	return 0;
}
</code></pre>
上二つは普通にカウントアップとカウントダウン。<br>
最後のは0, 1, 2, 3, 4, 5, 4, 3, 2, 1, 0ってなるちょっとアクロバティックな動作。<br>
<br>
いやー、キモい。<br>
C言語なのか何なのかよく分からない。<br>
マクロ良くないね。いや、適度な使用は良いんだろうけれど。うかつに使うと可読性が酷いことに。<br>
<br>
<br>
なお、上記ソースはtccのversion 0.9.25で動作確認しました。gccでやったらめっちゃ怒られました。<br>
