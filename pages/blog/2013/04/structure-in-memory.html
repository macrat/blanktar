メモリの中身と実行ファイル
2013-04-13 00:57

結局のところ。結局のところ、だ。<br>
<b>実行ファイル</b>、とは、なんぞや。<br>
てゆか、よく言われる<b>ヒープ</b>とか<b>スタック</b>とか、どこにあるんや。<br>
あと、exeファイルに<b>リソースを埋め込む</b>ってどこに埋め込んだんや。<br>
<br>
気になったので、調べたり妄想してみたりしました。正確かどうかはわかりませんが。<br>
上から順番に、ファイルで言うなら先頭の方、メモリで言うならアドレスの少ない方から昇順に参ります。<br>
<secrion>
	<h2>ヘッダー</h2>
	これは、ファイルにだけあるもの。<br>
	UNIX系なら<b>ELFヘッダ</b>ってのがあって、先頭の方にascii文字でELFって書いてあるらしい。<br>
	windowsだとなんか<b>PEヘッダ</b>とか<b>NEヘッダ</b>とか色々あってよく分からない。きもちわるい。<br>
	メモ帳で開くと<q>This program cannot bt run is DOS mode</q>ってのがあるので、見分けるのは簡単。<br>
	<br>
	動作するアーキテクチャとか、サイズとかもろもろが入ってるみたい。<br>
	つまりはメタデータっすね。<br>
</section>
<section>
	<h2>コード部</h2>
	プログラムの本体。機械言語でごりごり命令が書いてあるところ。<b>テキスト領域</b>、なんて呼び方もあるみたい。<br>
	ファイルならヘッダの後ろに書いてあって、メモリに読み込まれるのはここから先みたい。<br>
	先端からCPUが読みだして実行していく。<br>
</section>
<section>
	<h2>データ部</h2>
	ファイルだろうとメモリだろうと、とりあえずコード部の次にあるやつ。<b>静的領域</b>なんて呼び名も。<br>
	プログラムが使う文字列とか、画像とか、そういうのを埋め込むところ。<br>
	<b>リソースを埋め込む</b>のはここっぽいね。<br>
	試しにバイナリエディタでnotepad.exeを開いてみたら、一番後ろにはXMLがベタって埋め込んでありました。なんてこった。<br>
</section>
<section>
	<h2>ヒープ</h2>
	いよいよヒープだ。<b>スタック</b>でもあり、<b>データ領域</b>とも呼ぶようらしい。<br>
	ファイルにはなくて、メモリにだけある。ま、作業用の領域だしね。<br>
	こいつを頭（アドレスが小さい方）から読むとヒープ領域になって、尻尾（アドレスが大きい方）から読むとスタック領域になる。<br>
	・・・うん、意味わからん。<br>
	<br>
	どうやら領域を逆向きに読むことで共有しているようで。<br>
	なので配列の添字を無闇にでかくしてヒープを溢れると、スタック領域に触れてしまうらしい。<br>
	逆に、スタックオーバーフローってのはヒープ領域に届いてしまったってことみたいね。<br>
</section>
<br>
参考：<br>
<a href="http://www.me.tokushima-u.ac.jp/~miw/wadai/IP3/Tips/App&amp;memory.html" target="_blank">アプリケーションとメモリの関係 - 徳島大学大学院ソシオテクノサイエンス研究部</a><br>
<a href="http://brain.cc.kogakuin.ac.jp/~kanamaru/lecture/MP/final/part06/node8.html" target="_blank">メモリの4領域</a><br>
